# -*- coding: utf-8 -*-
"""task2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1n-Q_j3y88AXQEuxZFMXDd3CdUFnLmfbO

***Task 2: PREDICTION USING DECISION TREE ALGORITHM***

**Importing libraries and reading the data**
"""

import numpy as np
import pandas as pd 
ds=pd.read_csv('Iris.csv')

"""**Getting information about the dataset**"""

ds.info()

ds.describe()

"""**Preprocessing of data**"""

from sklearn.compose import ColumnTransformer
from sklearn.preprocessing import LabelEncoder
lEn=LabelEncoder()
ds.iloc[:,-1]=lEn.fit_transform(ds.iloc[:,-1])
ds

"""**Splitting data**"""

var=ds.iloc[:,:-1]
var.head()

var2=ds.iloc[:,-1]
var2.head()

from sklearn.model_selection import train_test_split
xtrain, xtest, ytrain, ytest= train_test_split(var,var2,test_size=0.2, random_state=50)
xtrain.head()

ytrain.head()

ytrain.shape

xtrain.shape

"""**Building the model** """

from sklearn.tree import DecisionTreeClassifier 
ds1=DecisionTreeClassifier()
ds1.fit(xtrain,ytrain)
ds1

"""**Comparison between the actual output and the predicted output**"""

ytest=np.array(ytest)
ytest

pred=ds1.predict(xtest)
pred

"""**Accuracy**"""

from sklearn.metrics import accuracy_score
accuracy_score(pred,ytest)

"""**Classification report** """

from sklearn.metrics import classification_report
print(classification_report(pred,ytest))

"""**Decision tree model visualization**"""

from sklearn import tree

from matplotlib import pyplot as plt
plt.figure(figsize=(15,15))
dtviz=tree.plot_tree(ds1,feature_names=var.columns,filled=True,fontsize=20)